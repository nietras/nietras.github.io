---
layout: post
title: Sep 0.2.3 - .NET 8 and AVX-512 Preview
---

Since [Sep 0.2.0 - Even Faster Parsing (~10 GB/s on Zen 3) and More]({{
site.baseurl }}/2023/08/07/sep-0.2.0), there have been a few minor releases of
Sep. I will cover those in this post with a focus on preview support .NET 8 and
AVX-512 and the related performance improvements.

## Release Notes

 * [Sep 0.2.1](https://github.com/nietras/Sep/releases/tag/v0.2.1)
   * Reduce row count in comparison benchmarks for faster runs. Reduces memory
     bandwidth impact so better shows code optimization efforts.
 * [Sep 0.2.2](https://github.com/nietras/Sep/releases/tag/v0.2.2)
   * Add `Reader(...)/Writer(...)` extension method overloads with `configure`.
     Fixes issue [How to create reader with separator and
     options?](https://github.com/nietras/Sep/issues/20) reported by
     [nwiman](https://github.com/nwiman), thanks!
 * [Sep 0.2.3](https://github.com/nietras/Sep/releases/tag/v0.2.3)
   * Add preview .NET 8 support with AVX-512 parsing and add benchmark results
     to git incl. Intel Xeon Silver 4316 with AVX-512 results.
   * Performance improvements range from minor 1.05x-1.10x to some very
     impressive 1.Yx improvements for float parsing in .NET 8.

Below I will focus on the .NET 8 and AVX-512 preview performance improvements.

## .NET 8 and AVX-512 Benchmark Results
For detailed benchmarks see [GitHub](https://github.com/nietras/Sep) and the new
`benchmarks` directory that contains BenchmarkDotNet outputs for each hardware
platform that I have access to and have benchmarked (only the 4316 has AVX-512):

* `AMD 5950X` X64 Platform Information
  ``` ini
  OS=Windows 10 (10.0.19044.2846/21H2/November2021Update)
  AMD Ryzen 9 5950X, 1 CPU, 32 logical and 16 physical cores
  ```
* `Intel Xeon Silver 4316` X64 Platform Information
  ``` ini
  OS=Windows 10 (10.0.17763.3287/1809/October2018Update/Redstone5)
  Intel Xeon Silver 4316 CPU 2.30GHz, 1 CPU, 40 logical and 20 physical cores
  ```
* `Neoverse N1` ARM64 Platform Information (cloud instance)
  ```ini
  OS=ubuntu 22.04
  Neoverse N1, ARM, 4 vCPU
  ```

And .NET runtimes:
 * .NET 7.0.10 (7.0.1023.36312)
 * .NET 8.0.0 Preview 6 (8.0.23.37506)

For this post I am going to focus on Sep results only and what improvements .NET
8 and AVX-512 appears to have. All details can be seen on GitHub incl.
description of the different benchmarks.

### PackageAssets 

|  Hardware | Scope | .NET   |    MB/s | ns/row | .NET   |    MB/s | ns/row | Speedup |
|---------- |------ | ------:|--------:|-------:| ------:|--------:|-------:| -------:|
| 5950X     |   Row | 7.0.10 | 11375.3 |   51.3 | 8.0 P6 | 11872.7 |   49.2 |    1.04 |
| 4316      |   Row | 7.0.10 |  4905.8 |  119.0 | 8.0 P6 |  5363.8 |  108.8 |    1.09 |
| N1        |   Row | 7.0.10 |  2393.9 |  243.0 | 8.0 P6 |  2421.2 |  240.3 |    1.01 |
|           |       |        |         |        |        |         |        |         |
| 5950X     |  Cols | 7.0.10 |  8769.4 |   66.6 | 8.0 P6 |  9153.5 |   63.8 |    1.04 |
| 4316      |  Cols | 7.0.10 |  3942.7 |  148.0 | 8.0 P6 |  4366.8 |  133.7 |    1.11 |
| N1        |  Cols | 7.0.10 |  2002.8 |  290.5 | 8.0 P6 |  2042.8 |  284.8 |    1.02 |
|           |       |        |         |        |        |         |        |         |
| 5950X     | Asset | 7.0.10 |   949.6 |  614.6 | 8.0 P6 |   960.1 |  607.9 |    1.01 |
| 4316      | Asset | 7.0.10 |   497.1 | 1174.2 | 8.0 P6 |   524.2 | 1113.4 |    1.05 |
| N1        | Asset | 7.0.10 |   414.5 | 1403.3 | 8.0 P6 |   429.5 | 1354.3 |    1.04 |

### PackageAssets with Quotes

|  Hardware | Scope | .NET   |    MB/s | ns/row | .NET   |    MB/s | ns/row | Speedup |
|---------- |------ | ------:|--------:|-------:| ------:|--------:|-------:| -------:|
| 5950X     |   Row | 7.0.10 |  | 8.0 P6 |  |         |
| 4316      |   Row | 7.0.10 |  | 8.0 P6 |  |         |
| N1        |   Row | 7.0.10 |  | 8.0 P6 |  |         |
| 5950X     |  Cols | 7.0.10 |  | 8.0 P6 |  |         |
| 4316      |  Cols | 7.0.10 |  | 8.0 P6 |  |         |
| N1        |  Cols | 7.0.10 |  | 8.0 P6 |  |         |
| 5950X     | Asset | 7.0.10 |  | 8.0 P6 |  |         |
| 4316      | Asset | 7.0.10 |  | 8.0 P6 |  |         |
| N1        | Asset | 7.0.10 |  | 8.0 P6 |  |         |


|  Hardware | Scope | .NET   |    MB/s | ns/row | .NET   |    MB/s | ns/row | Speedup |
|---------- |------ | ------:|--------:|-------:| ------:|--------:|-------:| -------:|
| 5950X     |   Row | 7.0.10 |  | 8.0 P6 |  |         |
| 4316      |   Row | 7.0.10 |  | 8.0 P6 |  |         |
| N1        |   Row | 7.0.10 |  | 8.0 P6 |  |         |
| 5950X     |  Cols | 7.0.10 |  | 8.0 P6 |  |         |
| 4316      |  Cols | 7.0.10 |  | 8.0 P6 |  |         |
| N1        |  Cols | 7.0.10 |  | 8.0 P6 |  |         |
| 5950X     | Asset | 7.0.10 |  | 8.0 P6 |  |         |
| 4316      | Asset | 7.0.10 |  | 8.0 P6 |  |         |
| N1        | Asset | 7.0.10 |  | 8.0 P6 |  |         |

